export default function buildContentSecurityPolicy({ directives }) {
    const result = [];
    const entries = directives instanceof Map
        ? directives.entries()
        : Object.entries(directives);
    const namesSeen = new Set();
    for (const [rawName, rawValue] of entries) {
        const name = rawName.replace(/([a-z])([A-Z])/g, "$1-$2").toLowerCase();
        if (namesSeen.has(name)) {
            throw new Error(`${rawName} is specified more than once`);
        }
        namesSeen.add(name);
        if (rawValue === true) {
            result.push(name);
            continue;
        }
        if (rawValue === false) {
            continue;
        }
        const value = typeof rawValue === "string" ? rawValue : rawValue.join(" ");
        result.push(value ? `${name} ${value}` : name);
    }
    return result.join("; ");
}
