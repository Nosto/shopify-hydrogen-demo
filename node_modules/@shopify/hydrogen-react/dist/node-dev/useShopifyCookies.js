"use strict";
Object.defineProperty(exports, Symbol.toStringTag, { value: "Module" });
const React = require("react");
const cookie = require("worktop/cookie");
const cartConstants = require("./cart-constants.js");
const cookiesUtils = require("./cookies-utils.js");
const longTermLength = 60 * 60 * 24 * 360 * 1;
const shortTermLength = 60 * 30;
function useShopifyCookies(options) {
  const {
    hasUserConsent = false,
    domain = "",
    checkoutDomain = ""
  } = options || {};
  React.useEffect(() => {
    const cookies = cookiesUtils.getShopifyCookies(document.cookie);
    let currentDomain = domain || window.document.location.host;
    if (checkoutDomain) {
      const checkoutDomainParts = checkoutDomain.split(".").reverse();
      const currentDomainParts = currentDomain.split(".").reverse();
      const sameDomainParts = [];
      checkoutDomainParts.forEach((part, index) => {
        if (part === currentDomainParts[index]) {
          sameDomainParts.push(part);
        }
      });
      currentDomain = sameDomainParts.reverse().join(".");
    }
    if (/^localhost/.test(currentDomain)) currentDomain = "";
    const domainWithLeadingDot = currentDomain ? /^\./.test(currentDomain) ? currentDomain : `.${currentDomain}` : "";
    if (hasUserConsent) {
      setCookie(
        cartConstants.SHOPIFY_Y,
        cookies[cartConstants.SHOPIFY_Y] || cookiesUtils.buildUUID(),
        longTermLength,
        domainWithLeadingDot
      );
      setCookie(
        cartConstants.SHOPIFY_S,
        cookies[cartConstants.SHOPIFY_S] || cookiesUtils.buildUUID(),
        shortTermLength,
        domainWithLeadingDot
      );
    } else {
      setCookie(cartConstants.SHOPIFY_Y, "", 0, domainWithLeadingDot);
      setCookie(cartConstants.SHOPIFY_S, "", 0, domainWithLeadingDot);
    }
  }, [options, hasUserConsent, domain, checkoutDomain]);
}
function setCookie(name, value, maxage, domain) {
  document.cookie = cookie.stringify(name, value, {
    maxage,
    domain,
    samesite: "Lax",
    path: "/"
  });
}
exports.useShopifyCookies = useShopifyCookies;
//# sourceMappingURL=useShopifyCookies.js.map
